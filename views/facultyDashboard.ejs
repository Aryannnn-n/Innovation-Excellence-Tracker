<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Faculty Dashboard - Innovation Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
  </head>

  <body class="bg-gradient-to-r from-green-100 to-green-300 min-h-screen">
    <!-- Floating Navbar -->
    <nav
      class="absolute top-4 left-1/2 transform -translate-x-1/2 bg-green-600 text-white w-[100%] max-w-6xl py-3 px-6 shadow-lg rounded-xl flex justify-between items-center"
    >
      <h1 class="text-xl font-bold">Faculty Dashboard</h1>
      <div class="relative flex items-center gap-4">
        <!-- <span class="font-semibold"> <%= user.name %> </span> -->

        <!-- Logout Button -->
        <a href="/logout" class="relative group flex items-center gap-2">
          <i class="fas fa-sign-out-alt text-xl text-white"></i>
          <span
            class="absolute left-1/2 transform -translate-x-1/2 bottom-[-30px] bg-green-200 text-black font-bold text-sm px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity"
          >
            Logout
          </span>
        </a>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-6xl mx-auto p-6 mt-20 bg-white shadow-lg rounded-lg">
      <h2 class="text-2xl font-bold text-green-600">
        Welcome, <%= user.name %>!
      </h2>

      <!-- Pending Proposals -->
      <h2 class="text-xl font-semibold mt-6 text-yellow-600">
        Pending Proposals
      </h2>
      <table class="w-full mt-4 border-collapse border border-gray-300">
        <thead class="bg-yellow-300">
          <tr>
            <th class="border border-gray-300 p-2">Sr. No.</th>
            <th class="border border-gray-300 p-2">Title</th>
            <th class="border border-gray-300 p-2">Student Name</th>
            <th class="border border-gray-300 p-2">Mentor</th>
            <th class="border border-gray-300 p-2">Submission Date</th>
            <th class="border border-gray-300 p-2">Action</th>
            <th class="border border-gray-300 p-2">File</th>
          </tr>
        </thead>
        <tbody>
          <% if (pendingProposals.length> 0) { %> <%
          pendingProposals.forEach((proposal, index)=> { %>
          <tr class="bg-yellow-50">
            <td class="border border-gray-300 p-2 text-center">
              <%= index + 1 %>
            </td>
            <td class="border border-gray-300 p-2"><%= proposal.title %></td>
            <td class="border border-gray-300 p-2 text-center">
              <%= proposal.studentName %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <%= proposal.mentors %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <%= proposal.date ? proposal.date.toISOString().slice(0, 10) :
              "N/A" %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <%= proposal.Collaborators %>
              <form action="/approve-proposal" method="POST" class="inline">
                <input
                  type="hidden"
                  name="proposalId"
                  value="<%= proposal._id %>"
                />
                <button
                  class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 transition"
                >
                  Approve
                </button>
              </form>
              <form action="/reject-proposal" method="POST" class="inline">
                <input
                  type="hidden"
                  name="proposalId"
                  value="<%= proposal._id %>"
                />
                <button
                  class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition"
                >
                  Reject
                </button>
              </form>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <a
                href="/uploads/<%= proposal.proposalFile %>"
                target="_blank"
                class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition"
              >
                View file
              </a>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <a href="/faculty/viewform/<%= proposal._id %>">view form</a>
            </td>
          </tr>
          <% }); %> <% } else { %>
          <tr>
            <td
              colspan="6"
              class="border border-gray-300 p-4 text-center bg-yellow-50 text-gray-500"
            >
              No pending proposals.
            </td>
          </tr>
          <% } %>
        </tbody>
      </table>

      <!-- Approved Proposals -->
      <h2 class="text-xl font-semibold mt-6 text-green-600">
        Approved Proposals
      </h2>
      <table class="w-full mt-4 border-collapse border border-gray-300">
        <thead class="bg-green-300">
          <tr>
            <th class="border border-gray-300 p-2 text-center">Sr. No.</th>
            <th class="border border-gray-300 p-2 text-center">Title</th>
            <th class="border border-gray-300 p-2 text-center">Student Name</th>
            <th class="border border-gray-300 p-2 text-center">Mentor</th>
            <th class="border border-gray-300 p-2 text-center">
              Submission Date
            </th>
            <th class="border border-gray-300 p-2 text-center">File</th>
          </tr>
        </thead>
        <tbody>
          <% if (approvedProposals.length> 0) { %> <%
          approvedProposals.forEach((proposal, index)=> { %>
          <tr class="bg-green-50">
            <td class="border border-gray-300 p-2 text-center">
              <%= index + 1 %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <%= proposal.title %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <%= proposal.studentName %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <%= proposal.mentors %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <%= proposal.date instanceof Date ?
              proposal.date.toISOString().slice(0, 10) : 'No Date Available' %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <a
                href="/uploads/<%= proposal.proposalFile %>"
                target="_blank"
                class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition"
              >
                View Report
              </a>
            </td>
          </tr>
          <% }); %> <% } else { %>
          <tr>
            <td
              colspan="5"
              class="border border-gray-300 p-4 text-center bg-green-50 text-gray-500"
            >
              No approved proposals yet.
            </td>
          </tr>
          <% } %>
        </tbody>
      </table>

      <!-- Rejected Proposals -->
      <h2 class="text-xl font-semibold mt-6 text-red-600">
        Rejected Proposals
      </h2>
      <table class="w-full mt-4 border-collapse border border-gray-300">
        <thead class="bg-red-300">
          <tr>
            <th class="border border-gray-300 p-2">Sr. No.</th>
            <th class="border border-gray-300 p-2">Title</th>
            <th class="border border-gray-300 p-2">Student Name</th>
            <th class="border border-gray-300 p-2">Mentor</th>
            <th class="border border-gray-300 p-2">Submission Date</th>
            <th class="border border-gray-300 p-2">File</th>
          </tr>
        </thead>
        <tbody>
          <% if (rejectedProposals.length> 0) { %> <%
          rejectedProposals.forEach((proposal, index)=> { %>
          <tr class="bg-red-50">
            <td class="border border-gray-300 p-2 text-center">
              <%= index + 1 %>
            </td>
            <td class="border border-gray-300 p-2"><%= proposal.title %></td>
            <td class="border border-gray-300 p-2">
              <%= proposal.studentName %>
            </td>
            <td class="border border-gray-300 p-2"><%= proposal.mentors %></td>
            <td class="border border-gray-300 p-2">
              <%= proposal.date ? proposal.date.toISOString().slice(0, 10) :
              "N/A" %>
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <a
                href="/uploads/<%= proposal.proposalFile %>"
                target="_blank"
                class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition"
              >
                View Report
              </a>
            </td>
          </tr>
          <% }); %> <% } else { %>
          <tr>
            <td
              colspan="5"
              class="border border-gray-300 p-4 text-center bg-red-50 text-gray-500"
            >
              No rejected proposals.
            </td>
          </tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </body>
</html>
